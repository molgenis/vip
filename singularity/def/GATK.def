Bootstrap: localimage
From: sif/build/OpenJDK.sif

%help
    Genome Analysis Toolkit - Variant Discovery in High-Throughput Sequencing Data.
    Usage: java -jar /opt/gatk/lib/gatk.jar

%post
    version=4.2.2.0

    # install
    apk update
    apk add libgomp
    apk add --virtual=.build-dependencies curl

    mkdir -p /opt/gatk/lib
    curl -Ls -o gatk.zip "https://github.com/broadinstitute/gatk/releases/download/${version}/gatk-${version}.zip"
    echo "ddd902441d1874493796566159288e9df178714ac18216ba05092136db1497fd  gatk.zip" | sha256sum -c
    unzip -p gatk.zip "gatk-${version}/gatk-package-${version}-local.jar" > /opt/gatk/lib/gatk.jar

    # cleanup
    apk del .build-dependencies
    rm -rf /var/cache/apk/* gatk.zip
