<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><link href="https://molgenis.github.io/vip/advanced/classification_trees/" rel="canonical"/>
<link href="../../img/favicon.ico" rel="shortcut icon"/>
<title>Classification trees - Variant Interpretation Pipeline</title>
<link href="../../css/theme.css" rel="stylesheet"/>
<link href="../../css/theme_extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" rel="stylesheet"/>
<link href="../../custom.css" rel="stylesheet"/>
<script>
        // Current page data
        var mkdocs_page_name = "Classification trees";
        var mkdocs_page_input_path = "advanced/classification_trees.md";
        var mkdocs_page_url = "/vip/advanced/classification_trees/";
      </script>
<!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../.."> Variant Interpretation Pipeline
        </a><div role="search">
<form action="../../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" title="Type search term here" type="text"/>
</form>
</div>
</div>
<div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<p class="caption"><span class="caption-text">Home</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../..">Introduction</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../home/key_features/">Key features</a>
</li>
</ul>
<p class="caption"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../get_started/requirements/">Requirements</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../get_started/installation/">Installation</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../get_started/start_running/">Start running</a>
</li>
</ul>
<p class="caption"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../usage/command-line-options/">Command-line options</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/workflow/">Workflow</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/input/">Input</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/output/">Output</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/config/">Config</a>
</li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples/nanopore/">Nanopore</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/multi-project/">Multi-project</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/reanalysis/">Reanalysis</a>
</li>
</ul>
<p class="caption"><span class="caption-text">Advanced</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../annotations/">Annotations</a>
</li>
<li class="toctree-l1 current"><a class="reference internal current" href="#">Classification trees</a>
<ul class="current">
<li class="toctree-l2"><a class="reference internal" href="#default">Default</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#variant-consequences">Variant-consequences</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#variant-consequences-samples">Variant-consequences (samples)</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#customization-and-filtering">Customization and filtering</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../report_templates/">Report templates</a>
</li>
</ul>
<p class="caption"><span class="caption-text">Help</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../help/issues/">Issues</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../help/frequently_asked_questions/">Frequently asked questions</a>
</li>
</ul>
<p class="caption"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about/license/">License</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../about/acknowledgements/">Acknowledgements</a>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../..">Variant Interpretation Pipeline</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Docs" class="icon icon-home" href="../.."></a></li>
<li class="breadcrumb-item">Advanced</li>
<li class="breadcrumb-item active">Classification trees</li>
<li class="wy-breadcrumbs-aside">
<a class="icon icon-github" href="https://github.com/molgenis/vip/edit/main/docs/advanced/classification_trees.md"> Edit on GitHub</a>
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div class="section" itemprop="articleBody">
<h1 id="classification-trees">Classification trees<a class="headerlink" href="#classification-trees" title="Permanent link">¶</a></h1>
<p>In order to end up with a small list of candidate variant records for interpretation VIP performs variant filtration by:</p>
<ol>
<li>Classify all variant-consequences based on variant annotations</li>
<li>Remove variant-consequences based on their classes</li>
<li>Annotate remaining variant records using inheritance matcher</li>
<li>Classify all variant-consequences based on variant annotations in the context of samples</li>
<li>Remove variant-consequences based on their classes.</li>
<li>Remove variants that had all their variant-consequences removed</li>
</ol>
<p>The following sections describe the default variant filtration strategies and how to customize classification and
filtration.</p>
<h2 id="default">Default<a class="headerlink" href="#default" title="Permanent link">¶</a></h2>
<p>VIP contains default filtration strategies for variant-consequences as well as variant-consequences in the context of
samples.</p>
<h3 id="variant-consequences">Variant-consequences<a class="headerlink" href="#variant-consequences" title="Permanent link">¶</a></h3>
<p>The default decision tree to classify variant-consequences works as follows:</p>
<ol>
<li>Each variant-consequence is classified as <code>Benign</code>, <code>Likely Benign</code>, <code>VUS</code>, <code>Likely Pathogenic</code>, <code>Pathogenic</code> or
   <code>Remove</code></li>
<li>Variant-consequences classified as <code>Benign</code>, <code>Likely Benign</code> and <code>Remove</code> are removed by default.</li>
</ol>
<div class="mermaid">flowchart TD
filter_("Filter")
vkgl_("VKGL")
clinVar_("ClinVar")
chrom_("Chromosome")
gene_("Gene")
sv_("Is SV")
str_("Is STR")
str_status_("STR Status")
gnomAD_("GnomAD")
gnomAD_AF_("GnomAD AF")
annotSV_("AnnotSV")
spliceAI_("SpliceAI")
utr5_("5' UTR")
capice_("CAPICE")
exit_rm_("Remove")
style exit_rm_ fill:#00ff00
exit_b_("B")
style exit_b_ fill:#00ff00
exit_lb_("LB")
style exit_lb_ fill:#00ff00
exit_vus_("VUS")
style exit_vus_ fill:#00ff00
exit_lp_("LP")
style exit_lp_ fill:#00ff00
exit_p_("P")
style exit_p_ fill:#00ff00
filter_ --&gt;|"true"| vkgl_
filter_ --&gt;|"false"| exit_rm_
filter_ --&gt;|"missing"| vkgl_
vkgl_ --&gt;|"P"| exit_p_
vkgl_ --&gt;|"default"| clinVar_
vkgl_ --&gt;|"B"| exit_b_
vkgl_ --&gt;|"LP"| exit_lp_
vkgl_ --&gt;|"VUS"| clinVar_
vkgl_ --&gt;|"LB"| exit_lb_
clinVar_ --&gt;|"default"| chrom_
clinVar_ --&gt;|"Conflict"| chrom_
clinVar_ --&gt;|"VUS"| chrom_
clinVar_ --&gt;|"LP/P"| exit_lp_
clinVar_ --&gt;|"missing"| chrom_
clinVar_ --&gt;|"B/LB"| exit_lb_
chrom_ --&gt;|"true"| gene_
chrom_ --&gt;|"false"| exit_rm_
chrom_ --&gt;|"missing"| gene_
gene_ --&gt;|"true"| gnomAD_
gene_ --&gt;|"false"| exit_rm_
sv_ --&gt;|"true"| str_
sv_ --&gt;|"false"| spliceAI_
str_ --&gt;|"true"| str_status_
str_ --&gt;|"false"| annotSV_
str_ --&gt;|"missing"| annotSV_
str_status_ --&gt;|"normal"| exit_lb_
str_status_ --&gt;|"default"| exit_vus_
str_status_ --&gt;|"pre_mutation"| exit_vus_
str_status_ --&gt;|"full_mutation"| exit_lp_
gnomAD_ --&gt;|"true"| sv_
gnomAD_ --&gt;|"false"| gnomAD_AF_
gnomAD_AF_ --&gt;|"default"| sv_
gnomAD_AF_ --&gt;|"missing"| sv_
gnomAD_AF_ --&gt;|"Filtering allele Frequency (99% confidence) &gt;= 0.02 or Number of Homozygotes &gt; 5"| exit_lb_
annotSV_ --&gt;|"1"| exit_b_
annotSV_ --&gt;|"default"| spliceAI_
annotSV_ --&gt;|"2"| exit_lb_
annotSV_ --&gt;|"3"| exit_vus_
annotSV_ --&gt;|"4"| exit_lp_
annotSV_ --&gt;|"5"| exit_p_
spliceAI_ --&gt;|"default"| utr5_
spliceAI_ --&gt;|"Delta score (acceptor/donor gain/loss) &gt; 0.13"| exit_vus_
spliceAI_ --&gt;|"Delta score (acceptor/donor gain/loss) &gt; 0.42"| exit_lp_
spliceAI_ --&gt;|"missing"| utr5_
utr5_ --&gt;|"true"| exit_vus_
utr5_ --&gt;|"false"| capice_
capice_ --&gt;|"true"| exit_lp_
capice_ --&gt;|"false"| exit_lb_
capice_ --&gt;|"missing"| exit_vus_
</div>
<p><em>Above: default GRCh38 variant classification tree</em></p>
<h3 id="variant-consequences-samples">Variant-consequences (samples)<a class="headerlink" href="#variant-consequences-samples" title="Permanent link">¶</a></h3>
<p>The default decision tree to classify variant-consequences in the context of samples works as follows:</p>
<ol>
<li>Each variant-consequence-sample is classified as <code>U1</code> (usable: probably), <code>U2</code> (usable: maybe), <code>U3</code> (usable:
   probably not) and <code>U4</code> (usable: only in cases of suspected incomplete penetrance).</li>
<li>Variant-consequences classified as <code>U3</code> and <code>U4</code> for all samples are removed by default.</li>
</ol>
<div class="mermaid">flowchart TD
gt_("Genotype")
gq_("Genotype quality")
only_IP_("Only if AD IP")
vig_("Inheritance match gene")
vim_("Inheritance match")
vig_IP_("Inheritance match gene (IP)")
vim_IP_("Inheritance match (IP)")
vid_("Inheritance denovo")
vid_IP_("Inheritance denovo (IP)")
exit_u1_("Usable: probably")
style exit_u1_ fill:#00ff00
exit_u2_("Usable: maybe")
style exit_u2_ fill:#00ff00
exit_u3_("Usable: probably not")
style exit_u3_ fill:#00ff00
exit_u4_("Usable: if IP")
style exit_u4_ fill:#00ff00
gt_ --&gt;|"default"| gq_
gt_ --&gt;|"HOM_REF"| exit_u3_
gt_ --&gt;|"NO_CALL"| exit_u3_
gt_ --&gt;|"MIXED"| gq_
gt_ --&gt;|"HET"| gq_
gt_ --&gt;|"HOM_VAR"| gq_
gt_ --&gt;|"UNAVAILABLE"| exit_u3_
gq_ --&gt;|"true"| only_IP_
gq_ --&gt;|"false"| exit_u3_
gq_ --&gt;|"missing"| only_IP_
only_IP_ --&gt;|"true"| vid_IP_
only_IP_ --&gt;|"false"| vig_
only_IP_ --&gt;|"missing"| vig_
vig_ --&gt;|"true"| vim_
vig_ --&gt;|"false"| vid_
vig_ --&gt;|"missing"| vid_
vim_ --&gt;|"true"| exit_u1_
vim_ --&gt;|"false"| exit_u3_
vim_ --&gt;|"missing"| exit_u2_
vig_IP_ --&gt;|"true"| vim_IP_
vig_IP_ --&gt;|"false"| exit_u3_
vig_IP_ --&gt;|"missing"| exit_u3_
vim_IP_ --&gt;|"true"| exit_u4_
vim_IP_ --&gt;|"false"| exit_u3_
vim_IP_ --&gt;|"missing"| exit_u4_
vid_ --&gt;|"true"| exit_u1_
vid_ --&gt;|"false"| exit_u3_
vid_ --&gt;|"missing"| exit_u2_
vid_IP_ --&gt;|"true"| exit_u1_
vid_IP_ --&gt;|"false"| vig_IP_
vid_IP_ --&gt;|"missing"| exit_u2_
</div>
<p><em>Above: default variant sample classification tree</em></p>
<h2 id="customization-and-filtering">Customization and filtering<a class="headerlink" href="#customization-and-filtering" title="Permanent link">¶</a></h2>
<p>Please note that the classification tree only classifies variants, and filtering based on those classes is handled in
the next step of the pipeline.
The behaviour of the filtering is based on the classes specified in the configuration of the pipeline.</p>
<h3 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">¶</a></h3>
<p>Detailed documentation on how to modify or create your own decision tree can be
found <a href="https://github.com/molgenis/vip-decision-tree">here</a>.</p>
<p>To use your modified or own decision tree the following parameter(s) should be updated (
see <a href="../../usage/config/#parameters">here</a>).
For the difference between the two configuration items see the sections above and the decision tree
module <a href="https://github.com/molgenis/vip-decision-tree">documentation</a>.</p>
<ul>
<li><code>vcf.classify.GRCh38.decision_tree</code></li>
<li><code>vcf.classify_samples.GRCh38.decision_tree</code></li>
</ul>
<p>To customize the filtering of the variants based on the classification the following parameters can be updated (
see <a href="../../usage/config/#parameters">here</a>).
These parameters should contain a comma separated list of classes (values of the LEAF nodes) of your decision tree you
would like to keep.</p>
<ul>
<li><code>vcf.filter.classes</code></li>
<li><code>vcf.filter_samples.classes</code></li>
</ul>
<p>The following repositories might be of interest when creating a new decision tree:</p>
<ul>
<li><a href="https://github.com/molgenis/vip/tree/main/resources">vip</a></li>
<li><a href="https://github.com/molgenis/vip-decision-tree">vip-decision-tree</a></li>
</ul>
</div>
</div><footer>
<div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-left" href="../annotations/" title="Annotations"><span class="icon icon-circle-arrow-left"></span> Previous</a>
<a class="btn btn-neutral float-right" href="../report_templates/" title="Report templates">Next <span class="icon icon-circle-arrow-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
<p>Copyright © 2023 University Medical Center Groningen All rights reserved</p>
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span>
<a class="fa fa-github" href="https://github.com/molgenis/vip/" style="color: #fcfcfc"> GitHub</a>
</span>
<span><a href="../annotations/" style="color: #fcfcfc">« Previous</a></span>
<span><a href="../report_templates/" style="color: #fcfcfc">Next »</a></span>
</span>
</div>
<script src="../../js/jquery-3.6.0.min.js"></script>
<script>var base_url = "../..";</script>
<script src="../../js/theme_extra.js"></script>
<script src="../../js/theme.js"></script>
<script src="../../js/mermaid.min.js"></script>
<script src="../../search/main.js"></script>
<script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>
<script>mermaid.initialize({});</script></body>
</html>
